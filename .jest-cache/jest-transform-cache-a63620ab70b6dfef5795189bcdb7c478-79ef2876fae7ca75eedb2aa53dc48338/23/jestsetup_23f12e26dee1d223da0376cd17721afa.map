{"version":3,"sources":["/Users/seaofchaos/Projects/next-map/jest.setup.js"],"sourcesContent":["/**\n * Jest Setup File for Next Map Project\n * \n * This file runs before each test and sets up the testing environment\n * with necessary mocks and global configurations.\n */\n\n// Import Jest DOM matchers\nimport '@testing-library/jest-dom'\n\n// Mock i18next modules for testing\njest.mock('i18next-http-backend', () => ({}))\njest.mock('i18next-browser-languagedetector', () => ({}))\n\n// Mock react-i18next with improved translation handling\njest.mock('react-i18next', () => ({\n  useTranslation: (namespace = 'common') => ({\n    t: (key) => {\n      // Handle namespace:key format\n      const translations = {\n        'common:welcome': 'Welcome to Next Map',\n        'navigation:home': 'Home',\n        'navigation:explore': 'Explore',\n        'navigation:about': 'About',\n        'auth:signIn': 'Sign In',\n        'auth:signOut': 'Sign Out',\n        'map:title': 'Map Title',\n        'errors:generic': 'An unexpected error occurred',\n        'homepage:hero.title': 'Welcome to Next Map',\n        'homepage:hero.subtitle': 'Explore the world in 3D',\n      }\n      \n      // If key doesn't contain namespace, prepend the current namespace\n      const fullKey = key.includes(':') ? key : `${namespace}:${key}`\n      return translations[fullKey] || key\n    },\n    i18n: {\n      language: 'en',\n      changeLanguage: jest.fn().mockResolvedValue(undefined),\n      exists: jest.fn().mockReturnValue(true),\n      dir: jest.fn().mockReturnValue('ltr'),\n    },\n    ready: true,\n  }),\n  initReactI18next: {\n    type: '3rdParty',\n    init: jest.fn(),\n  },\n}))\n\n// Mock our consolidated i18n utilities\njest.mock('@/lib/i18n', () => ({\n  __esModule: true,\n  default: {\n    language: 'en',\n    changeLanguage: jest.fn().mockResolvedValue(undefined),\n    t: jest.fn((key) => key),\n  },\n  supportedLanguages: [\n    { code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' },\n    { code: 'es', name: 'EspaÃ±ol', flag: 'ðŸ‡ªðŸ‡¸' },\n    { code: 'fr', name: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·' },\n  ],\n  changeLanguage: jest.fn().mockResolvedValue(true),\n  getCurrentLanguage: jest.fn().mockReturnValue('en'),\n  getLanguageInfo: jest.fn().mockReturnValue({ code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' }),\n  isLanguageSupported: jest.fn().mockReturnValue(true),\n  getBrowserLanguage: jest.fn().mockReturnValue('en'),\n  formatDate: jest.fn().mockReturnValue('January 1, 2024'),\n  formatNumber: jest.fn().mockReturnValue('1,000'),\n  formatCurrency: jest.fn().mockReturnValue('$1,000.00'),\n  getTextDirection: jest.fn().mockReturnValue('ltr'),\n  translateWithFallback: jest.fn((key, fallback) => fallback),\n}))\n\n// Mock next/router\njest.mock('next/router', () => ({\n  useRouter() {\n    return {\n      route: '/',\n      pathname: '/',\n      query: {},\n      asPath: '/',\n      push: jest.fn(),\n      pop: jest.fn(),\n      reload: jest.fn(),\n      back: jest.fn(),\n      prefetch: jest.fn().mockResolvedValue(undefined),\n      beforePopState: jest.fn(),\n      events: {\n        on: jest.fn(),\n        off: jest.fn(),\n        emit: jest.fn(),\n      },\n    }\n  },\n}))\n\n// Mock next/navigation for App Router\njest.mock('next/navigation', () => ({\n  useRouter() {\n    return {\n      push: jest.fn(),\n      replace: jest.fn(),\n      prefetch: jest.fn(),\n      back: jest.fn(),\n      forward: jest.fn(),\n      refresh: jest.fn(),\n    }\n  },\n  useSearchParams() {\n    return new URLSearchParams()\n  },\n  usePathname() {\n    return '/'\n  },\n}))\n\n// Mock MapLibre GL JS\njest.mock('maplibre-gl', () => ({\n  Map: jest.fn(() => ({\n    on: jest.fn(),\n    off: jest.fn(),\n    remove: jest.fn(),\n    addLayer: jest.fn(),\n    removeLayer: jest.fn(),\n    getLayer: jest.fn(),\n    addSource: jest.fn(),\n    removeSource: jest.fn(),\n    getSource: jest.fn(),\n    fitBounds: jest.fn(),\n    flyTo: jest.fn(),\n    setCenter: jest.fn(),\n    setZoom: jest.fn(),\n    getCenter: jest.fn(),\n    getZoom: jest.fn(),\n    getBearing: jest.fn(),\n    getPitch: jest.fn(),\n    setBearing: jest.fn(),\n    setPitch: jest.fn(),\n  })),\n  NavigationControl: jest.fn(),\n  GeolocateControl: jest.fn(),\n  ScaleControl: jest.fn(),\n}))\n\n// Mock react-map-gl/maplibre\njest.mock('react-map-gl/maplibre', () => ({\n  Map: jest.fn(({ children, ...props }) => (\n    <div data-testid=\"map\" {...props}>{children}</div>\n  )),\n  NavigationControl: () => <div data-testid=\"navigation-control\" />,\n  GeolocateControl: () => <div data-testid=\"geolocate-control\" />,\n  ScaleControl: () => <div data-testid=\"scale-control\" />,\n}))\n\n// Global test utilities\nglobalThis.ResizeObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}))\n\nglobalThis.IntersectionObserver = jest.fn().mockImplementation(() => ({\n  observe: jest.fn(),\n  unobserve: jest.fn(),\n  disconnect: jest.fn(),\n}))"],"names":["jest","mock","useTranslation","namespace","t","key","translations","fullKey","includes","i18n","language","changeLanguage","fn","mockResolvedValue","undefined","exists","mockReturnValue","dir","ready","initReactI18next","type","init","__esModule","default","supportedLanguages","code","name","flag","getCurrentLanguage","getLanguageInfo","isLanguageSupported","getBrowserLanguage","formatDate","formatNumber","formatCurrency","getTextDirection","translateWithFallback","fallback","useRouter","route","pathname","query","asPath","push","pop","reload","back","prefetch","beforePopState","events","on","off","emit","replace","forward","refresh","useSearchParams","URLSearchParams","usePathname","Map","remove","addLayer","removeLayer","getLayer","addSource","removeSource","getSource","fitBounds","flyTo","setCenter","setZoom","getCenter","getZoom","getBearing","getPitch","setBearing","setPitch","NavigationControl","GeolocateControl","ScaleControl","children","props","div","data-testid","globalThis","ResizeObserver","mockImplementation","observe","unobserve","disconnect","IntersectionObserver"],"mappings":"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"}